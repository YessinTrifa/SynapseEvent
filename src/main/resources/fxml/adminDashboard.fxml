<?xml version="1.0" encoding="UTF-8"?>

<?import java.net.URL?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane minWidth="900" styleClass="app-root" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.synapseevent.controller.AdminDashboardController">

    <!-- LEFT SIDEBAR -->
    <left>
        <VBox fx:id="sidebar" prefWidth="240" minWidth="200" spacing="10" styleClass="sidebar">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <ImageView fitHeight="62.0" fitWidth="58.0" preserveRatio="true">
                    <image>
                  <Image url="@../images/logo.png" />
               </image>
                </ImageView>
                <Label prefHeight="46.0" prefWidth="138.0" styleClass="sidebar-title" text="SynapseEvent" />
            </HBox>

            <Button fx:id="navDashboard" onAction="#showDashboard" styleClass="nav-btn" text="Dashboard" />
            <Button fx:id="navUsers" onAction="#showUsers" styleClass="nav-btn" text="Users" />
            <Button fx:id="navEvents" onAction="#showEvents" styleClass="nav-btn" text="Events" />
            <Button fx:id="navBookings" onAction="#showBookings" styleClass="nav-btn" text="Bookings" />
            <Button fx:id="navRequests" onAction="#showRequests" styleClass="nav-btn" text="Requests" />
            <Button fx:id="navEnterprises" onAction="#showEnterprises" styleClass="nav-btn" text="Enterprises" />

            <Region VBox.vgrow="ALWAYS" />
            <Label styleClass="muted" text="Â© SynapseEvent" />
        </VBox>
    </left>

    <!-- TOP BAR -->
    <top>
        <HBox spacing="12" styleClass="topbar">
            <Label styleClass="top-title" text="Admin Dashboard">
            <font>
               <Font name="System Bold Italic" size="12.0" />
            </font></Label>
            <Region HBox.hgrow="ALWAYS" />
            <Button onAction="#logout" styleClass="btn-danger" text="Logout" />
        </HBox>
    </top>

    <!-- CENTER CONTENT -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="false" hbarPolicy="NEVER" styleClass="scroll-clean" maxWidth="Infinity">
            <content>
                <VBox maxWidth="Infinity" spacing="16" styleClass="content">
                    <!-- PAGE: Dashboard -->
                    <VBox fx:id="pageDashboard" managed="true" spacing="16" visible="true">
                        <HBox fx:id="kpiWrap" spacing="16" HBox.hgrow="ALWAYS">
                            <VBox maxWidth="Infinity" styleClass="kpi-card" HBox.hgrow="ALWAYS">
                                <Label styleClass="kpi-icon" text="ðŸ‘¥" />
                                <Label styleClass="muted" text="Total Users" />
                                <Label fx:id="totalUsersLabel" styleClass="kpi-number" text="0" />
                            </VBox>
                            <VBox maxWidth="Infinity" styleClass="kpi-card" HBox.hgrow="ALWAYS">
                                <Label styleClass="kpi-icon" text="ðŸ“…" />
                                <Label styleClass="muted" text="Total Events" />
                                <Label fx:id="totalEventsLabel" styleClass="kpi-number" text="0" />
                            </VBox>
                            <VBox maxWidth="Infinity" styleClass="kpi-card" HBox.hgrow="ALWAYS">
                                <Label styleClass="kpi-icon" text="ðŸ•" />
                                <Label styleClass="muted" text="Pending Bookings" />
                                <Label fx:id="pendingBookingsLabel" styleClass="kpi-number" text="0" />
                            </VBox>
                            <VBox maxWidth="Infinity" styleClass="kpi-card" HBox.hgrow="ALWAYS">
                                <Label styleClass="kpi-icon" text="ðŸ“‹" />
                                <Label styleClass="muted" text="Open Requests" />
                                <Label fx:id="openRequestsLabel" styleClass="kpi-number" text="0" />
                            </VBox>
                        </HBox>

                        <GridPane hgap="16" maxWidth="1e9" vgap="16">
                            <columnConstraints>
                                <ColumnConstraints hgrow="ALWAYS" minWidth="300" />
                                <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                            </columnConstraints>
                            <rowConstraints>
                                <RowConstraints />
                                <RowConstraints />
                            </rowConstraints>

                            <VBox spacing="10" styleClass="card-web" GridPane.columnIndex="0">
                                <HBox spacing="10">
                                    <Label styleClass="card-title-web" text="Bookings (last 7 days)" />
                                    <Region HBox.hgrow="ALWAYS" />
                                    <ComboBox fx:id="bookingRangeCombo" prefWidth="140" />
                                </HBox>
                                <LineChart fx:id="bookingsChart" animated="false" maxHeight="200" prefHeight="200">
                                    <xAxis><CategoryAxis /></xAxis>
                                    <yAxis><NumberAxis /></yAxis>
                                </LineChart>
                            </VBox>

                            <VBox spacing="10" styleClass="card-web" GridPane.columnIndex="1">
                                <Label styleClass="card-title-web" text="Popular event types" />
                                <BarChart fx:id="popularChart" animated="false" maxHeight="200" prefHeight="200">
                                    <xAxis><CategoryAxis /></xAxis>
                                    <yAxis><NumberAxis /></yAxis>
                                </BarChart>
                            </VBox>

                            <VBox spacing="10" styleClass="card-web" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label styleClass="card-title-web" text="Calendar" />
                                    <Region HBox.hgrow="ALWAYS" />
                                    <Button fx:id="calPrev" styleClass="cal-nav-btn" text="â€¹" />
                                    <Label fx:id="calMonthLabel" styleClass="cal-month-label" text="February 2026" />
                                    <Button fx:id="calNext" styleClass="cal-nav-btn" text="â€º" />
                                </HBox>
                                <GridPane fx:id="calendarGrid" alignment="CENTER" hgap="4" vgap="4" />
                            </VBox>
                        </GridPane>
                    </VBox>

                    <!-- PAGE: Users -->
                    <VBox fx:id="pageUsers" managed="false" spacing="10" styleClass="card-web" visible="false">
                        <HBox spacing="12">
                            <Label styleClass="card-title-web" text="Users" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button onAction="#addUser" styleClass="btn-primary" text="+ Add User" />
                            <Button onAction="#createEnterprise" styleClass="btn-secondary" text="+ Create Enterprise" />
                        </HBox>
                        <TableView fx:id="usersTable" styleClass="table-web" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="userNameColumn" text="Name" />
                                <TableColumn fx:id="userEmailColumn" text="Email" />
                                <TableColumn fx:id="userRoleColumn" text="Role" />
                                <TableColumn fx:id="userActionColumn" text="Actions" />
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- PAGE: Events -->
                    <VBox fx:id="pageEvents" managed="false" spacing="14" styleClass="card-web" visible="false">
                        <HBox spacing="10">
                            <Label styleClass="card-title-web" text="Events" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label styleClass="muted" text="Type" />
                            <ComboBox fx:id="eventTypeFilter" onAction="#filterEventsByType" prefWidth="180" />
                        </HBox>
                        <Label styleClass="section-label" text="RECENT EVENTS" />
                        <HBox fx:id="eventCardsRow" spacing="12" />
                        <TableView fx:id="eventsTable" prefHeight="280" styleClass="table-web" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="eventNameColumn" text="Name" />
                                <TableColumn fx:id="eventDateColumn" text="Date" />
                                <TableColumn fx:id="eventLocationColumn" text="Location" />
                                <TableColumn fx:id="eventCapacityColumn" text="Capacity" />
                                <TableColumn fx:id="eventPriceColumn" text="Price" />
                                <TableColumn fx:id="eventStatusColumn" text="Status" />
                                <TableColumn fx:id="eventTypeColumn" text="Type" />
                                <TableColumn fx:id="eventActionColumn" text="Actions" />
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- PAGE: Bookings -->
                    <VBox fx:id="pageBookings" managed="false" spacing="10" styleClass="card-web" visible="false">
                        <Label styleClass="card-title-web" text="Bookings" />
                        <TableView fx:id="bookingsTable" styleClass="table-web" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="bookingUserColumn" text="User" />
                                <TableColumn fx:id="bookingTypeColumn" text="Event" />
                                <TableColumn fx:id="bookingEventIdColumn" text="Event ID" />
                                <TableColumn fx:id="bookingDateColumn" text="Booking Date" />
                                <TableColumn fx:id="bookingStatusColumn" text="Status" />
                                <TableColumn fx:id="bookingActionColumn" text="Actions" />
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- PAGE: Requests -->
                    <VBox fx:id="pageRequests" managed="false" spacing="10" styleClass="card-web" visible="false">
                        <Label styleClass="card-title-web" text="Custom Requests" />
                        <TableView fx:id="customRequestsTable" styleClass="table-web" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="requestUserColumn" text="User" />
                                <TableColumn fx:id="requestTypeColumn" text="Type" />
                                <TableColumn fx:id="requestDateColumn" text="Date" />
                                <TableColumn fx:id="requestBudgetColumn" text="Budget" />
                                <TableColumn fx:id="requestCapacityColumn" text="Capacity" />
                                <TableColumn fx:id="requestLocationColumn" text="Location" />
                                <TableColumn fx:id="requestDetailsColumn" text="Details" />
                                <TableColumn fx:id="requestReasonColumn" text="Reason" />
                                <TableColumn fx:id="requestStatusColumn" text="Status" />
                                <TableColumn fx:id="requestActionColumn" text="Actions" />
                            </columns>
                        </TableView>
                    </VBox>

                    <!-- PAGE: Enterprises -->
                    <VBox fx:id="pageEnterprises" managed="false" spacing="10" styleClass="card-web" visible="false">
                        <Label styleClass="card-title-web" text="Enterprises" />
                        <TableView fx:id="entreprisesTable" styleClass="table-web" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="entrepriseNameColumn" text="Name" />
                                <TableColumn fx:id="entrepriseSiretColumn" text="SIRET" />
                                <TableColumn fx:id="entrepriseActionColumn" text="Actions" />
                            </columns>
                        </TableView>
                    </VBox>

                </VBox>
            </content>
        </ScrollPane>
    </center>
    <stylesheets>
        <URL value="@../css/auth.css" />
        <URL value="@../css/dashboard.css" />
    </stylesheets>

</BorderPane>
