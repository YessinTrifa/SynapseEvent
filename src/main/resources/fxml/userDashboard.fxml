<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Spinner?>
<?import javafx.scene.control.SpinnerValueFactory?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.paint.Color?>
<?import javafx.scene.paint.RadialGradient?>
<?import javafx.scene.paint.Stop?>

<VBox spacing="18"
      styleClass="page-wrap"
      stylesheets="@../css/auth.css"
      xmlns="http://javafx.com/javafx/25"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.synapseevent.controller.UserDashboardController">
    <!-- Header -->
    <HBox alignment="CENTER_LEFT" styleClass="web-header">
        <Label text="SynapseEvent" styleClass="web-logo-text">
            <textFill>
                <RadialGradient centerX="0.5" centerY="0.5" radius="0.5">
                    <stops>
                        <Stop>
                            <color>
                                <Color red="0.8954386115074158" green="0.9134151935577393" blue="0.9157894849777222" />
                            </color>
                        </Stop>
                        <Stop offset="1.0">
                            <color>
                                <Color red="0.16830000281333923" green="0.3146097660064697" blue="0.33000001311302185" />
                            </color>
                        </Stop>
                    </stops>
                </RadialGradient>
            </textFill>
        </Label>
        <Region HBox.hgrow="ALWAYS" />
        <Label text="User Dashboard" styleClass="top-muted"/>
        <Region prefWidth="20" />
        <Button text="Logout" onAction="#logout" styleClass="btn-danger"/>
    </HBox>

    <!-- Main TabPane with improved spacing -->
    <TabPane fx:id="categoryTabPane" style="-fx-background-color: transparent; -fx-padding: 15 20 20 20;" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">
        
        <!-- Home Tab -->
        <Tab style="-fx-background-color: #1e293b; -fx-text-fill: #94a3b8; -fx-font-size: 13;" text="Home">
            <content>
                <VBox spacing="20" style="-fx-background-color: rgba(15, 23, 42, 0.5); -fx-background-radius: 12; -fx-padding: 20;">
                    <!-- Filter Controls -->
                    <HBox spacing="12" alignment="CENTER_LEFT" styleClass="filter-bar">                        <Label style="-fx-font-weight: 600;" text="ðŸ“ Venue:" textFill="white" />
                        <ComboBox fx:id="locationFilterCombo" HBox.hgrow="ALWAYS" maxWidth="Infinity" styleClass="combo-web" prefWidth="180" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-border-color: rgba(255,255,255,0.2); -fx-background-radius: 6;" />
                        
                        <Label style="-fx-font-weight: 600;" text="ðŸŽ­ Type:" textFill="white" />
                        <ComboBox fx:id="typeFilterCombo" HBox.hgrow="ALWAYS" maxWidth="Infinity" styleClass="combo-web" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-border-color: rgba(255,255,255,0.2); -fx-background-radius: 6;" />
                        
                        <Label style="-fx-font-weight: 600;" text="ðŸ“… From:" textFill="white" />
                        <DatePicker fx:id="dateFromPicker" HBox.hgrow="ALWAYS" maxWidth="Infinity" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-background-radius: 6;" />
                        
                        <Label style="-fx-font-weight: 600;" text="To:" textFill="white" />
                        <DatePicker fx:id="dateToPicker" HBox.hgrow="ALWAYS" maxWidth="Infinity" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-background-radius: 6;" />
                        
                        <Region HBox.hgrow="ALWAYS" />
                        <Button text="Apply Filters" onAction="#applyFilters" styleClass="btn-primary"/>
                        <Button text="Clear" onAction="#clearFilters" styleClass="btn-ghost"/>
                    </HBox>
                    
                    <!-- Featured Events Section -->
                    <VBox spacing="10" styleClass="card-web" >
                        <Label style="-fx-font-size: 18; -fx-font-weight: bold;" text="â­ Featured Events" textFill="white" />
                        <TableView fx:id="featuredEventsTable"  styleClass="section-title" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="featuredNameColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Name" />
                                <TableColumn fx:id="featuredTypeColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Type" />
                                <TableColumn fx:id="featuredDateColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Date" />
                                <TableColumn fx:id="featuredLocationColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Location" />
                                <TableColumn fx:id="featuredPriceColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Price" />
                                <TableColumn fx:id="featuredActionColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Book" />
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                    </VBox>
                    
                    <!-- All Events Section -->
                    <VBox spacing="10" styleClass="card-web">
                        <Label styleClass="section-title" text="ðŸŽ‰ All Available Events"  />
                        <TableView fx:id="allEventsTable" style="-fx-background-color: rgba(30, 41, 59, 0.4); -fx-background-radius: 8; -fx-border-color: rgba(255,255,255,0.1); -fx-border-radius: 8; -fx-text-fill: white;" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="allNameColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Name" />
                                <TableColumn fx:id="allTypeColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Type" />
                                <TableColumn fx:id="allDateColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Date" />
                                <TableColumn fx:id="allLocationColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Location" />
                                <TableColumn fx:id="allPriceColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Price" />
                                <TableColumn fx:id="allStatusColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Status" />
                                <TableColumn fx:id="allActionColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Book" />
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                    </VBox>
                </VBox>
            </content>
        </Tab>
        
        <!-- Browse by Type Tab -->
        <Tab style="-fx-background-color: #1e293b; -fx-text-fill: #94a3b8; -fx-font-size: 13;" text="Browse by Type">
            <content>
                <TabPane fx:id="eventsTabPane" style="-fx-background-color: transparent;">
                    <!-- Dynamic tabs will be created here -->
                </TabPane>
            </content>
        </Tab>
        
        <!-- My Bookings Tab -->
        <Tab style="-fx-background-color: #1e293b; -fx-text-fill: #94a3b8; -fx-font-size: 13;" text="My Bookings">
            <content>
                <VBox spacing="15" style="-fx-background-color: rgba(15, 23, 42, 0.5); -fx-background-radius: 12; -fx-padding: 20;">
                    <Label style="-fx-font-size: 18; -fx-font-weight: bold;" text="ðŸ“‹ My Booking History" textFill="white" />
                    <TableView fx:id="bookingsTable" style="-fx-background-color: rgba(30, 41, 59, 0.4); -fx-background-radius: 8; -fx-border-color: rgba(255,255,255,0.1); -fx-border-radius: 8; -fx-text-fill: white;" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="bookingTypeColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Event Name" />
                            <TableColumn fx:id="bookingEventIdColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Event ID" />
                            <TableColumn fx:id="bookingDateColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Booking Date" />
                            <TableColumn fx:id="bookingStatusColumn" style="-fx-text-fill: white; -fx-background-color: #1e293b;" text="Status" />
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </content>
        </Tab>
        
        <!-- Custom Request Tab -->
        <Tab style="-fx-background-color: #1e293b; -fx-text-fill: #94a3b8; -fx-font-size: 13;" text="Custom Request">
            <content>
                <VBox spacing="15" style="-fx-background-color: rgba(15, 23, 42, 0.5); -fx-background-radius: 12; -fx-padding: 20;">
                    <Label style="-fx-font-size: 18; -fx-font-weight: bold;" text="âœ¨ Create Custom Event Request" textFill="white" />
                    
                    <HBox spacing="15">
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="ðŸŽ­ Event Type:" textFill="#94a3b8" />
                            <ComboBox fx:id="eventTypeCombo" HBox.hgrow="ALWAYS" maxWidth="Infinity" styleClass="combo-web" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-border-color: rgba(255,255,255,0.2); -fx-background-radius: 6;" />
                        </VBox>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ“… Event Date:" textFill="#94a3b8" />
                            <DatePicker fx:id="eventDatePicker" HBox.hgrow="ALWAYS" maxWidth="Infinity" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-background-radius: 6;" />
                        </VBox>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ’° Budget (TND):" textFill="#94a3b8" />
                            <TextField fx:id="budgetField" promptText="Enter budget" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-prompt-text-fill: #64748b; -fx-background-radius: 6;" />
                        </VBox>
                    </HBox>
                    
                    <HBox spacing="15">
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ‘¥ Capacity:" textFill="#94a3b8" />
                            <Spinner fx:id="capacitySpinner" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white;">
                                <valueFactory>
                                    <SpinnerValueFactory.IntegerSpinnerValueFactory min="1" max="10000" initialValue="50" />
                                </valueFactory>
                            </Spinner>
                        </VBox>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ¢ Venue Type:" textFill="#94a3b8" />
                            <ComboBox fx:id="venueTypeFilterComboBox" HBox.hgrow="ALWAYS" maxWidth="Infinity" styleClass="combo-web" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-border-color: rgba(255,255,255,0.2); -fx-background-radius: 6;" />
                        </VBox>
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ“ City:" textFill="#94a3b8" />
                            <ComboBox fx:id="cityFilterComboBox" HBox.hgrow="ALWAYS" maxWidth="Infinity" styleClass="combo-web" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-border-color: rgba(255,255,255,0.2); -fx-background-radius: 6;" />
                        </VBox>
                    </HBox>
                    
                    <VBox spacing="5">
                        <Label text="ðŸŸï¸ Venue:" textFill="#94a3b8" />
                        <ComboBox fx:id="venueComboBox" HBox.hgrow="ALWAYS" maxWidth="Infinity" styleClass="combo-web" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-border-color: rgba(255,255,255,0.2); -fx-background-radius: 6;" />
                    </VBox>
                    
                    <VBox spacing="5" VBox.vgrow="ALWAYS">
                        <Label text="ðŸ“ Description:" textFill="#94a3b8" />
                        <TextArea fx:id="descriptionArea" prefRowCount="4" promptText="Enter event description" style="-fx-background-color: rgba(30, 41, 59, 0.8); -fx-text-fill: white; -fx-prompt-text-fill: #64748b; -fx-background-radius: 6;" />
                    </VBox>
                    
                    <Button fx:id="submitRequestButton" onAction="#submitCustomRequest" style="-fx-background-color: #10b981; -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 12 24; -fx-font-size: 14; -fx-font-weight: 600;" text="Submit Request" />
                </VBox>
            </content>
        </Tab>
    </TabPane>
</VBox>
